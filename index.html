<!DOCTYPE html>
<html>
<body>

<p>Jaxc very simple WebMIDI page, plug in a midi keyboard and press ONE key.
<br>
The key pressed should be written on the page below</p>
<p id="demo"></p>
<script>

if (navigator.requestMIDIAccess) {
    navigator.requestMIDIAccess()
    .then(onMIDISuccess, onMIDIFailure);
} else {
	document.getElementById('demo').innerHTML = 'WebMIDI is not supported in this browser.'
    console.log('WebMIDI is not supported in this browser.');
}


function onMIDISuccess(midiAccess) {
    console.log(midiAccess);

    var inputs = midiAccess.inputs;
    var outputs = midiAccess.outputs;
}

function onMIDIFailure() {
    console.log('Could not access your MIDI devices.');
	
}

function onMIDISuccess(midiAccess) {
    for (var input of midiAccess.inputs.values())
        input.onmidimessage = getMIDIMessage;
    }


function getMIDIMessage(message) {
    var command = message.data[0];
    var note = message.data[1];
    var velocity = (message.data.length > 2) ? message.data[2] : 0; // a velocity value might not be included with a noteOff command

    switch (command) {
        case 144: // noteOn
            if (velocity > 0) {
                noteOn(note, velocity);
            } else {
                noteOff(note);
            }
            break;
        case 128: // noteOff
            noteOff(note);
            break;
        // we could easily expand this switch statement to cover other types of commands such as controllers or sysex
    }
}
function MidiLookup(note) {
  switch (note % 12) {
    case 0:
      return "C";
    break;

    case 1:
      return "C#";
    break;

    case 2:
      return "D";
    break;

    case 3:
      return "D#";
    break;

    case 4:
      return "E";
    break;

    case 5:
      return "F";
    break;

    case 6:
      return "F#";
    break;

    case 7:
      return "G";
    break;

    case 8:
      return "G#";
    break;

    case 9:
      return "A";
    break;

    case 10:
      return "A#";
    break;

    case 11:
      return "B";
    break;
  }
};
function noteOn(note, velocity) {
	document.getElementById('demo').innerHTML = MidiLookup(note)
}

function noteOff(note, velocity) {
	document.getElementById('demo').innerHTML = ''
}
</script>



</body>
</html> 
